<div class="initiative-bar">
    <ng-container *ngFor="let player of getSortedPlayers()">
        <div class="player-icon" *ngIf="showInitCoin(player)">
            <div class="initiative-icon" (contextmenu)="boardMap_handleContextMenu($event)">
                <div style="height: 40px; width: 40px; border: 3px solid #383838; background: #d8d8d8; border-radius: 50%; position: absolute">
                    <img src="{{player.tokenUrl}}" style="height: 100%; border-radius: 25px;">
                    <mat-icon class="not-visible-icon" *ngIf="!player.isVisible">visibility_off</mat-icon>
                    <mat-icon class="dead-icon" *ngIf="player.isDead">close</mat-icon>
                </div>
                <div
                    style="height:40px; width: 40px; border: 3px solid #383838; border-radius: 50%; position: absolute; cursor: pointer"
                    (mouseup)="boardMap_handleInitIconMouseUp($event, player)"
                    (mouseover)="boardMap_mouseOverInitIcon(player)"
                    matTooltip="{{player.name}}"
                    matTooltipPosition="after">
                </div>
                <div (mouseup)="boardMap_handleInitBadgeMouseUp($event, player)"
                     class="font initiativeBadge">
                    {{player.initiative}}
                </div>

            </div>
            <div class="conditions-icons" *ngIf="rulesConfigService.hasConditions || rulesConfigService.hasHiddenAndSneaking">
	            <ng-container *ngIf="rulesConfigService.hasConditions">
		            <mat-icon *ngFor="let condition of player.characterData.values['Conditions']" [style.color]="condition.color"
		                      [matTooltip]="condition.name + ' | ' + condition.description">
			            {{condition.icon}}
		            </mat-icon>
	            </ng-container>
	            <ng-container *ngIf="rulesConfigService.hasHiddenAndSneaking && player.characterData.values[RuleModuleAspects.HIDDEN] === 'true'">
		            <mat-icon [matTooltip]="'Hidden | ' + player.characterData.values[RuleModuleAspects.STEALTH]">visibility_off</mat-icon>
	            </ng-container>
            </div>
        </div>
    </ng-container>
</div>

<div style="height: 100%; width: 100%;" #mapContainer>
    <map-renderer></map-renderer>
    <token-renderer></token-renderer>
    <light-renderer></light-renderer>
    <wall-renderer></wall-renderer>
    <visibility-renderer></visibility-renderer>
    <grid-renderer></grid-renderer>
    <hover-renderer></hover-renderer>
    <highlight-renderer></highlight-renderer>
    <notation-renderer></notation-renderer>
    <diagnostic-renderer></diagnostic-renderer>

    <canvas
            class="inputCanvas"
            [ngClass]="getCursorClass()"
            height={{boardStateService.canvasElement_height}} width={{boardStateService.canvasElement_width}}
            (mouseleave)="boardMap_handleMouseLeave($event)"
            (mouseenter)="boardMap_handleMouseEnter($event)"
            (mouseWheelUp)="boardMap_handleMouseWheel($event)"
            (mouseWheelDown)="boardMap_handleMouseWheel($event)"
            (mousemove)="boardMap_mouseMove($event)"
            (mousedown)="boardMap_handleMouseDown($event)"
            (mouseup)="boardMap_handleMouseUp($event)"
            (contextmenu)="boardMap_handleContextMenu($event)"
            (click)="boardMap_clickResponse()"
            mouseWheel>
    </canvas>
</div>


